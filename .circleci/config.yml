version: 2.1

setup: true

orbs:
  path-filtering: circleci/path-filtering@1.0.0

parameters:
  aws-web:
    type: boolean
    default: false
  identity-center:
    type: boolean
    default: false
  openai-web:
    type: boolean
    default: false

workflows:
  dispatch:
    jobs:
      - path-filtering/filter:
          name: workflow-dispatch
          mapping: |
            aws-web/.* aws-web true
            identity-center/.* identity-center true
            openai-web/.* openai-web true
          base-revision: master
          config-path: .circleci/next.yml

  aws-web:
    when: << parameters.aws-web >>
    jobs:
      - go-build:
          name: aws-web-build
          project-name: aws-web
          project-path: aws-web
          go-image: cimg/go:1.21.5

  identity-center:
    when: << parameters.identity-center >>
    jobs:
      - go-build:
          name: identity-center-build
          project-name: identity-center
          project-path: identity-center

  openai-web:
    when: << parameters.openai-web >>
    jobs:
      - go-build:
          name: openai-web-build
          project-name: openai-web
          project-path: openai-web
